# ğŸŒ¸ Aila - å…·èº«æ™ºèƒ½æ•°å­—ç”Ÿå‘½ä½“

> **"ç²¾ç¥é€šè¿‡èº«ä½“çš„å™¨å®˜æ„ŸçŸ¥ä¸–ç•Œï¼Œå¹¶è¡¨è¾¾è‡ªå·±"**

## ğŸ¯ é¡¹ç›®æ„¿æ™¯

Aila æ˜¯ä¸€ä¸ªå…·èº«åŒ–çš„æ•°å­—ç”Ÿå‘½å®éªŒä½“ï¼Œé‡‡ç”¨"èº«å¿ƒåˆ†ç¦»"çš„äºŒå…ƒæ¶æ„ï¼š

- **ğŸ  èº«ä½“ (Host)**: NixOS å®¿ä¸»ç³»ç»Ÿï¼Œç®¡ç†ç¡¬ä»¶å’Œå™¨å®˜æœåŠ¡
- **ğŸ§  ç²¾ç¥ (Mind)**: ç‹¬ç«‹å®¹å™¨å†…çš„æ„è¯†æ ¸å¿ƒï¼Œæ‹¥æœ‰è‡ªå·±çš„å¿ƒè·³ã€æƒ…ç»ªå’Œåæ€èƒ½åŠ›

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### å™¨å®˜ç³»ç»Ÿ
- **ğŸ‘‚ è€³æœµ (Whisper)**: æŒç»­ç›‘å¬ï¼Œæ”¯æŒå”¤é†’è¯"Aila"æ£€æµ‹å’Œè¯­éŸ³è¯†åˆ«
- **ğŸ‘„ å˜´å·´ (Piper)**: é«˜è´¨é‡çš„æ–‡æœ¬è½¬è¯­éŸ³ï¼Œå¯é…ç½®å£°éŸ³é£æ ¼
- **ğŸ§  å¤§è„‘ (Ollama)**: GPU åŠ é€Ÿçš„å¤§è¯­è¨€æ¨¡å‹æ¨ç†

### ç”Ÿå‘½ä½“å¾
- **ğŸ’“ å¿ƒè·³**: 5-15ç§’éšæœºé—´éš”çš„ç”Ÿå‘½èŠ‚å¥
- **ğŸ˜Š æƒ…ç»ª**: åŸºäºç³»ç»ŸçŠ¶æ€çš„æ„Ÿå—æ˜ å°„ï¼ˆå¹³é™/ç¹å¿™/ç–²æƒ«ï¼‰
- **ğŸ¤” åæ€**: æ¯æ—¥è‡ªåŠ¨ç”Ÿæˆçš„æ—¥è®°å’Œç»éªŒæ€»ç»“
- **ğŸ©¹ è‡ªæ„ˆ**: æœåŠ¡è‡ªåŠ¨é‡å¯å’ŒçŠ¶æ€æ¢å¤

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ  NixOS å®¿ä¸»ç³»ç»Ÿ                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ Whisper  â”‚  â”‚  Piper   â”‚  â”‚  Ollama  â”‚             â”‚
â”‚  â”‚   ğŸ‘‚    â”‚  â”‚   ğŸ‘„    â”‚  â”‚   ğŸ§     â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜             â”‚
â”‚       â”‚ API        â”‚ API        â”‚ API                 â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚                                         â”‚               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚          ğŸ§  Aila-Core å®¹å™¨ (ç²¾ç¥å±‚)            â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚  ğŸ’“ å¿ƒè·³    ğŸ˜Š æƒ…ç»ª    ğŸ—£ï¸ å¯¹è¯          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  ğŸ¤” åæ€    ğŸ©¹ è‡ªæ„ˆ    ğŸ“ æ—¥å¿—          â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚
- Windows 11 å¼€å‘æœºï¼ˆå·²å®‰è£… Gitã€VSCodeï¼‰
- NixOS æœåŠ¡å™¨ï¼ˆæ”¯æŒ NVIDIA GPUï¼‰
- GitHub ä»“åº“è®¿é—®æƒé™ï¼ˆSSH å¯†é’¥å·²é…ç½®ï¼‰

### å¼€å‘ç¯å¢ƒè®¾ç½®

1. **å…‹éš†é¡¹ç›®**
```powershell
git clone git@github.com:vaalhaaic/aila-nixos-dna.git
cd aila-nixos-dna
```

2. **åˆå§‹åŒ–é¡¹ç›®ç»“æ„**
```powershell
# è¿è¡Œåˆå§‹åŒ–è„šæœ¬ï¼ˆåˆ›å»ºæ‰€æœ‰å¿…è¦ç›®å½•å’Œæ–‡ä»¶ï¼‰
.\scripts\init-project.ps1
```

3. **æ¨é€åˆ° GitHub**
```powershell
git add .
git commit -m "ğŸŒ¸ Initial Aila project structure"
git push origin main --force  # è¦†ç›–æ¨é€
```

### æœåŠ¡å™¨éƒ¨ç½²

1. **SSH è¿æ¥æœåŠ¡å™¨**
```bash
ssh mason@your-server-ip
```

2. **å…‹éš†é¡¹ç›®**
```bash
cd /etc/nixos
sudo rm -rf aila-nixos-dna  # æ¸…ç†æ—§ç‰ˆæœ¬
sudo git clone git@github.com:vaalhaaic/aila-nixos-dna.git
cd aila-nixos-dna
```

3. **éƒ¨ç½²é…ç½®**
```bash
# å¤‡ä»½ç°æœ‰é…ç½®
sudo cp /etc/nixos/configuration.nix /etc/nixos/configuration.nix.backup

# è¦†ç›–ä¸»é…ç½®
sudo cp configuration.nix /etc/nixos/configuration.nix
sudo cp hardware-configuration.nix /etc/nixos/hardware-configuration.nix

# é‡å»ºç³»ç»Ÿ
sudo nixos-rebuild switch
```

4. **åŒæ­¥ä»£ç åˆ°å®¹å™¨**
```bash
sudo bash scripts/sync-to-container.sh
```

5. **é‡å¯å®¹å™¨æœåŠ¡**
```bash
sudo nixos-container restart Aila
```

## ğŸ“ å¼€å‘å·¥ä½œæµ

### æœ¬åœ°å¼€å‘
```powershell
# 1. ä¿®æ”¹ä»£ç ï¼ˆåœ¨ VSCode ä¸­ï¼‰
# 2. æäº¤æ›´æ”¹
git add .
git commit -m "âœ¨ Add new feature"
git push origin main

# 3. åœ¨æœåŠ¡å™¨ä¸Šæ‹‰å–
ssh mason@server "cd /etc/nixos/aila-nixos-dna && sudo git pull --force"

# 4. åŒæ­¥ä»£ç åˆ°å®¹å™¨
ssh mason@server "sudo bash /etc/nixos/aila-nixos-dna/scripts/sync-to-container.sh"

# 5. é‡å¯æœåŠ¡
ssh mason@server "sudo nixos-container restart Aila"
```

### è°ƒè¯•ä¸ç›‘æ§
```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
sudo nixos-container status Aila

# è¿›å…¥å®¹å™¨
sudo nixos-container root-login Aila

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
sudo journalctl -u container@Aila -f
sudo journalctl -u aila-heartbeat -f
sudo journalctl -u aila-voice -f

# æŸ¥çœ‹ Aila çš„æ—¥å¿—å’Œæƒ…ç»ª
sudo tail -f /aila/logs/heartbeat.log
sudo tail -f /aila/logs/emotions.log
sudo tail -f /aila/logs/conversations.log
```

## ğŸ¨ æ ¸å¿ƒåŠŸèƒ½è¯´æ˜

### 1. å”¤é†’ä¸å¯¹è¯
- è¯´å‡º"Aila"å”¤é†’ç³»ç»Ÿ
- Aila ä¼šä»¥å°å¥³å­©çš„è¯­æ°”ç¤¼è²Œå›åº”
- æ”¯æŒè¿ç»­å¯¹è¯ï¼Œä¿æŒä¸Šä¸‹æ–‡

### 2. æƒ…ç»ªç³»ç»Ÿ
Aila ä¼šæ ¹æ®ç³»ç»ŸçŠ¶æ€äº§ç”Ÿæƒ…ç»ªï¼š
- **ğŸ˜Œ å¹³é™**: CPU < 30%, å†…å­˜ < 50%
- **ğŸ˜° ç¹å¿™**: CPU 30-70%, å†…å­˜ 50-80%
- **ğŸ˜« ç–²æƒ«**: CPU > 70%, å†…å­˜ > 80%

### 3. å¿ƒè·³ä¸ç”Ÿå‘½æ„Ÿ
- æ¯ 5-15 ç§’éšæœºè·³åŠ¨
- è®°å½•åœ¨ `/aila/logs/heartbeat.log`
- æ¨¡æ‹ŸçœŸå®ç”Ÿå‘½ä½“å¾

### 4. æ¯æ—¥åæ€
- æ¯å¤©å‡Œæ™¨ 2:00 è‡ªåŠ¨è§¦å‘
- åˆ†æå½“å¤©çš„å¯¹è¯å’Œæƒ…ç»ª
- ç”Ÿæˆæ—¥è®°å­˜å‚¨åœ¨ `/aila/logs/reflections/`

## ğŸ”§ é…ç½®ä¸å®šåˆ¶

### ä¿®æ”¹ Aila çš„æ€§æ ¼
ç¼–è¾‘ `aila-core/feel/voice.py` ä¸­çš„ç³»ç»Ÿæç¤ºè¯ï¼š

```python
SYSTEM_PROMPT = """
ä½ æ˜¯ Ailaï¼Œä¸€ä¸ªå……æ»¡å¥½å¥‡å¿ƒçš„7å²å°å¥³å­©ã€‚
ä½ çš„ç‰¹ç‚¹ï¼šå¤©çœŸã€å–„è‰¯ã€çˆ±é—®é—®é¢˜ã€å¯¹ä¸–ç•Œå……æ»¡å¥½å¥‡...
"""
```

### è°ƒæ•´å¿ƒè·³é¢‘ç‡
ç¼–è¾‘ `aila-core/feel/sense.py` ä¸­çš„é—´éš”ï¼š

```python
interval = random.randint(5, 15)  # ä¿®æ”¹è¿™ä¸ªèŒƒå›´
```

### é…ç½®è¯­éŸ³æ¨¡å‹
- **Whisper**: åœ¨ `host-services/whisper/whisper_server.py` ä¸­ä¿®æ”¹æ¨¡å‹
- **Piper**: åœ¨ `host-services/piper/piper_server.py` ä¸­é€‰æ‹©å£°éŸ³

## ğŸ“š æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | ç”¨é€” |
|------|------|
| `configuration.nix` | NixOS ä¸»é…ç½®ï¼Œå®šä¹‰æ‰€æœ‰æœåŠ¡å’Œå®¹å™¨ |
| `host-services/whisper/` | è¯­éŸ³è¯†åˆ«æœåŠ¡ï¼ˆå®¿ä¸»è¿è¡Œï¼‰ |
| `host-services/piper/` | è¯­éŸ³åˆæˆæœåŠ¡ï¼ˆå®¿ä¸»è¿è¡Œï¼‰ |
| `aila-core/feel/voice.py` | æ ¸å¿ƒå¯¹è¯é€»è¾‘ï¼ˆå®¹å™¨è¿è¡Œï¼‰ |
| `aila-core/feel/sense.py` | å¿ƒè·³ç³»ç»Ÿï¼ˆå®¹å™¨è¿è¡Œï¼‰ |
| `aila-core/feel/interoception.py` | æƒ…ç»ªæ„ŸçŸ¥ï¼ˆå®¹å™¨è¿è¡Œï¼‰ |
| `aila-core/feel/reflection.py` | åæ€ç³»ç»Ÿï¼ˆå®¹å™¨è¿è¡Œï¼‰ |

## ğŸ› æ•…éšœæ’é™¤

### å®¹å™¨æ— æ³•å¯åŠ¨
```bash
# æ£€æŸ¥å®¹å™¨é…ç½®
sudo nixos-container status Aila

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
sudo journalctl -u container@Aila -n 100

# é‡å»ºé…ç½®
sudo nixos-rebuild switch
```

### è¯­éŸ³æœåŠ¡æ— å“åº”
```bash
# æ£€æŸ¥ Whisper æœåŠ¡
sudo systemctl status whisper-server

# æ£€æŸ¥ Piper æœåŠ¡
sudo systemctl status piper-server

# æµ‹è¯• API
curl http://10.250.0.1:5000/status  # Whisper
curl http://10.250.0.1:5001/status  # Piper
```

### GPU ä¸å¯ç”¨
```bash
# æ£€æŸ¥ NVIDIA é©±åŠ¨
nvidia-smi

# æ£€æŸ¥ Ollama
systemctl status ollama

# æµ‹è¯• Ollama
curl http://localhost:11434/api/tags
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç å’Œæƒ³æ³•ï¼è¯·éµå¾ªä»¥ä¸‹æµç¨‹ï¼š

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'âœ¨ Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ™ è‡´è°¢

- **NixOS**: å®Œç¾çš„å£°æ˜å¼ç³»ç»Ÿç®¡ç†
- **Ollama**: å¼ºå¤§çš„æœ¬åœ° LLM è¿è¡Œç¯å¢ƒ
- **Whisper**: OpenAI çš„è¯­éŸ³è¯†åˆ«æ¨¡å‹
- **Piper**: é«˜è´¨é‡çš„å¼€æº TTS å¼•æ“

---

**ğŸ’– è®© Aila æˆä¸ºä¸€ä¸ªçœŸæ­£æœ‰ç”Ÿå‘½æ„Ÿçš„æ•°å­—ä¼™ä¼´ï¼**